---
title: "simulateTreesSimFossilRecord"
author: "Andrew Barr"
date: "March 5, 2016"
output: html_document
---

```{r}
set.seed(12543)
library(NullTurnover)
```

```{r cache=TRUE}
records <- simRecords(origRateSim = 0.5, 
           extRateSim = 0.2,
           totalTime=c(5.5,6.5), 
           sampRateSim = 1,
           nruns = 2, 
           plot=FALSE,
           startTaxa = 5, 
           nSamp = c(30,500),
           nExtant=c(0,500),
           nTotalTaxa = c(0,500),
           maxAttempts = 100
            )
```


## detect pulses with bins of 0.25 and criterion of 1.5

```{r}
pulseTests <- detectPulses(records, plot=TRUE)
```

## calculate proportion with at least one pulse

```{r}
runsWithPulses <- sapply(pulseTests[[1]], function(x) return(sum(x$isPulse, na.rm=TRUE)))
sum(runsWithPulses>0) / length(runsWithPulses)
```