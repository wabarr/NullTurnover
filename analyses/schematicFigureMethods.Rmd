---
title: "SchematicFigure"
author: "Andrew Barr"
date: "January 22, 2016"
output: html_document
---


```{r}
library(phytools)
library(ggtree)
library(gridExtra)
library(NullTurnover)
set.seed(111)
```

```{r}
theTree <- pbtree(n=100, scale=7)
basicTreePlot <- ggplot(theTree, aes(x, y)) + geom_tree() + theme_tree()
```


```{r}
panel1 <- basicTreePlot + labs(title="(A) Simulate Tree")
SEQ <- seq(from=0, to=7, length.out = 11)
panel2 <- basicTreePlot + 
           geom_vline(xintercept=SEQ[-11], lty=5) + 
           labs(title="(B) Apply Time Bins")
footRates <- detectPulses(theTree, plotRates = T, returnRatePlot = T)[[2]] + labs(x="Interval (Ma)") + theme_bw(10)
panel3 <- footRates + 
            labs(title="(C) Calculate Foote Rates") 
panel4 <- footRates + 
            labs(title="(D) Apply Turnover Pulse Criterion")
grid.arrange(panel1, panel3, panel2, panel4, ncol=2, nrow=2)
```

```{r}

```